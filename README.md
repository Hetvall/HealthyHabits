# üå± HealthyHabits API

Una API REST para gestionar h√°bitos saludables construida con **Spring Boot 3** y **MySQL**.

## üìã Tabla de Contenidos

- [Descripci√≥n](#-descripci√≥n)
- [Tecnolog√≠as](#Ô∏è-tecnolog√≠as)
- [Prerrequisitos](#-prerrequisitos)
- [Configuraci√≥n de Base de Datos](#Ô∏è-configuraci√≥n-de-base-de-datos)
- [Instalaci√≥n y Ejecuci√≥n](#-instalaci√≥n-y-ejecuci√≥n)
- [Endpoints de la API](#-endpoints-de-la-api)
- [Ejemplos con CURL](#-ejemplos-con-curl)
- [Pruebas con Postman](#-pruebas-con-postman)
- [Validaciones](#-validaciones)
- [Manejo de Errores](#Ô∏è-manejo-de-errores)
- [Estructura del Proyecto](#-estructura-del-proyecto)
- [Soluci√≥n de Problemas](#-soluci√≥n-de-problemas)

## üìñ Descripci√≥n

HealthyHabits es una API REST que permite a los usuarios gestionar sus h√°bitos saludables. Los usuarios pueden crear, leer, actualizar y eliminar h√°bitos organizados por tipo y frecuencia.

### Caracter√≠sticas principales:
- ‚úÖ CRUD completo para h√°bitos
- ‚úÖ Validaciones robustas con anotaciones personalizadas
- ‚úÖ Manejo centralizado de errores
- ‚úÖ Filtros por tipo y frecuencia
- ‚úÖ Base de datos MySQL
- ‚úÖ Documentaci√≥n completa con CURL y Postman

## üõ†Ô∏è Tecnolog√≠as

- **Java 17**
- **Spring Boot 3.5.0**
- **Spring Data JPA**
- **Spring Boot Validation**
- **MySQL 8.0**
- **Lombok**
- **Gradle 8.x**

## üìã Prerrequisitos

Antes de ejecutar el proyecto, aseg√∫rate de tener instalado:

- ‚òï **Java 17** o superior
- üê¨ **MySQL 8.0** o superior
- üîß **IntelliJ IDEA** (recomendado) o cualquier IDE de Java
- üìÆ **Postman** (opcional, para pruebas)

## üóÑÔ∏è Configuraci√≥n de Base de Datos

### 1. Instalar MySQL

**Windows:**
```bash
# Descargar desde: https://dev.mysql.com/downloads/installer/
# O usar MySQL Workbench
```

**macOS:**
```bash
brew install mysql
brew services start mysql
```

**Linux (Ubuntu/Debian):**
```bash
sudo apt update
sudo apt install mysql-server
sudo systemctl start mysql
```

### 2. Crear la Base de Datos

```sql
-- Conectarse a MySQL como root
mysql -u root -p

-- Crear la base de datos (nombre actualizado)
CREATE DATABASE healthyHabits_db;

-- Verificar que se cre√≥ correctamente
SHOW DATABASES;

-- Usar la base de datos
USE healthyHabits_db;

-- Salir de MySQL
EXIT;
```

### 3. Configuraci√≥n Actual

El proyecto est√° configurado con las siguientes credenciales en `application.properties`:

```properties
spring.application.name=HealthyHabits

# Configuraci√≥n de base de datos MySQL
spring.datasource.url=jdbc:mysql://localhost:3306/healthyHabits_db
spring.datasource.username=root
spring.datasource.password=Manchester17
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Configuraci√≥n de Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.format_sql=true

# Configuraci√≥n adicional
spring.jpa.open-in-view=false
server.port=8080
```

> üìù **Importante:** Si tu password de MySQL es diferente a `Manchester17`, modifica el archivo `src/main/resources/application.properties`

## üöÄ Instalaci√≥n y Ejecuci√≥n

### Opci√≥n 1: Desde IntelliJ IDEA (Recomendado)

1. **Abrir el proyecto:**
   - `File > Open` ‚Üí Seleccionar la carpeta `HealthyHabits`
   - Esperar a que Gradle descargue las dependencias

2. **Ejecutar la aplicaci√≥n:**
   - Buscar la clase `HealthyHabitsApplication`
   - Click derecho ‚Üí `Run 'HealthyHabitsApplication'`
   - O usar el bot√≥n ‚ñ∂Ô∏è verde

3. **Verificar ejecuci√≥n:**
   - Buscar en los logs: `Tomcat started on port 8080`
   - La aplicaci√≥n estar√° en: http://localhost:8080

### Opci√≥n 2: Desde Terminal

```bash
# 1. Navegar al directorio del proyecto
cd HealthyHabits

# 2. Compilar el proyecto
./gradlew clean build

# 3. Ejecutar la aplicaci√≥n
./gradlew bootRun

# 4. Verificar que est√° corriendo
curl http://localhost:8080/habits
```

### 4. Verificaci√≥n R√°pida

```bash
# Deber√≠a retornar un array vac√≠o: []
curl -X GET http://localhost:8080/habits
```

## üåê Endpoints de la API

### Base URL: `http://localhost:8080`

| M√©todo | Endpoint | Descripci√≥n |
|--------|----------|-------------|
| `POST` | `/habits` | Crear un nuevo h√°bito |
| `GET` | `/habits` | Obtener todos los h√°bitos |
| `GET` | `/habits/{id}` | Obtener un h√°bito por ID |
| `PUT` | `/habits/{id}` | Actualizar un h√°bito |
| `DELETE` | `/habits/{id}` | Eliminar un h√°bito |
| `GET` | `/habits/tipo/{tipo}` | Filtrar h√°bitos por tipo |
| `GET` | `/habits/frecuencia/{frecuencia}` | Filtrar h√°bitos por frecuencia |

### Modelo de Datos

```json
{
  "id": 1,
  "nombre": "Ejercicio matutino",
  "tipo": "Salud F√≠sica",
  "frecuencia": "Diario",
  "objetivo": "Hacer 30 minutos de ejercicio todas las ma√±anas"
}
```

## üíª Ejemplos con CURL

### üìù 1. Crear H√°bitos (POST)

```bash
# Crear h√°bito de ejercicio
curl -X POST http://localhost:8080/habits \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Ejercicio matutino",
    "tipo": "Salud F√≠sica",
    "frecuencia": "Diario",
    "objetivo": "Hacer 30 minutos de ejercicio cardiovascular todas las ma√±anas"
  }'

# Crear h√°bito mental
curl -X POST http://localhost:8080/habits \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Meditaci√≥n diaria",
    "tipo": "Mental",
    "frecuencia": "Diario",
    "objetivo": "Meditar 15 minutos al d√≠a para reducir el estr√©s"
  }'

# Crear h√°bito de alimentaci√≥n
curl -X POST http://localhost:8080/habits \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Beber agua",
    "tipo": "Alimentaci√≥n",
    "frecuencia": "Semanal",
    "objetivo": "Tomar 8 vasos de agua diarios durante toda la semana"
  }'
```

### üìã 2. Obtener Todos los H√°bitos (GET)

```bash
# Listar todos los h√°bitos
curl -X GET http://localhost:8080/habits

# Con informaci√≥n detallada de la respuesta
curl -X GET http://localhost:8080/habits -v
```

### üîç 3. Obtener H√°bito por ID (GET)

```bash
# Obtener h√°bito con ID 1
curl -X GET http://localhost:8080/habits/1

# Obtener h√°bito con ID 2
curl -X GET http://localhost:8080/habits/2

# Probar con ID inexistente (retorna error 404)
curl -X GET http://localhost:8080/habits/999
```

### ‚úèÔ∏è 4. Actualizar H√°bitos (PUT)

```bash
# Actualizar h√°bito con ID 1
curl -X PUT http://localhost:8080/habits/1 \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Ejercicio intensivo",
    "tipo": "Salud F√≠sica",
    "frecuencia": "Mensual",
    "objetivo": "Ejercicio de alta intensidad una vez al mes"
  }'

# Actualizar h√°bito con ID 2
curl -X PUT http://localhost:8080/habits/2 \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Meditaci√≥n avanzada",
    "tipo": "Mental",
    "frecuencia": "Semanal",
    "objetivo": "Practicar meditaci√≥n mindfulness 3 veces por semana"
  }'
```

### üóëÔ∏è 5. Eliminar H√°bitos (DELETE)

```bash
# Eliminar h√°bito con ID 3
curl -X DELETE http://localhost:8080/habits/3

# Eliminar con informaci√≥n detallada
curl -X DELETE http://localhost:8080/habits/1 -v

# Probar eliminar h√°bito inexistente (error 404)
curl -X DELETE http://localhost:8080/habits/999
```

### üîé 6. Filtrar por Tipo (GET)

```bash
# Filtrar h√°bitos por tipo "Salud F√≠sica"
curl -X GET "http://localhost:8080/habits/tipo/Salud%20F√≠sica"

# Filtrar h√°bitos por tipo "Mental"
curl -X GET http://localhost:8080/habits/tipo/Mental

# Filtrar h√°bitos por tipo "Alimentaci√≥n"
curl -X GET "http://localhost:8080/habits/tipo/Alimentaci√≥n"
```

### üìÖ 7. Filtrar por Frecuencia (GET)

```bash
# Filtrar h√°bitos con frecuencia "Diario"
curl -X GET http://localhost:8080/habits/frecuencia/Diario

# Filtrar h√°bitos con frecuencia "Semanal"
curl -X GET http://localhost:8080/habits/frecuencia/Semanal

# Filtrar h√°bitos con frecuencia "Mensual"
curl -X GET http://localhost:8080/habits/frecuencia/Mensual
```

### ‚ùå 8. Comandos para Probar Validaciones

```bash
# Error: nombre vac√≠o
curl -X POST http://localhost:8080/habits \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "",
    "tipo": "Mental",
    "frecuencia": "Diario",
    "objetivo": "Test objetivo"
  }'

# Error: tipo inv√°lido
curl -X POST http://localhost:8080/habits \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Test h√°bito",
    "tipo": "TipoInv√°lido",
    "frecuencia": "Diario",
    "objetivo": "Test objetivo"
  }'

# Error: frecuencia inv√°lida
curl -X POST http://localhost:8080/habits \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Test h√°bito",
    "tipo": "Mental",
    "frecuencia": "FrecuenciaInv√°lida",
    "objetivo": "Test objetivo"
  }'
```

## üìÆ Pruebas con Postman

### üöÄ M√©todo 1: Importar CURL a Postman

1. **Abrir Postman**
2. **Click en "Import"** (bot√≥n naranja)
3. **Seleccionar "Raw text"**
4. **Pegar cualquier comando CURL** (ejemplo):

```bash
curl --location 'http://localhost:8080/habits' \
--header 'Content-Type: application/json' \
--data '{
    "nombre": "Ejercicio matutino",
    "tipo": "Salud F√≠sica",
    "frecuencia": "Diario",
    "objetivo": "Hacer 30 minutos de ejercicio todas las ma√±anas"
}'
```

5. **Click "Continue" ‚Üí "Import"**

### üìã M√©todo 2: Configuraci√≥n Manual

#### **1. ‚ûï CREAR H√ÅBITO (POST)**
- **URL:** `http://localhost:8080/habits`
- **Method:** `POST`
- **Headers:** `Content-Type: application/json`
- **Body (raw/JSON):**
```json
{
  "nombre": "Ejercicio matutino",
  "tipo": "Salud F√≠sica",
  "frecuencia": "Diario",
  "objetivo": "Hacer 30 minutos de ejercicio todas las ma√±anas"
}
```

#### **2. üìã VER TODOS LOS H√ÅBITOS (GET)**
- **URL:** `http://localhost:8080/habits`
- **Method:** `GET`
- **Headers:** (ninguno necesario)

#### **3. üîç VER H√ÅBITO POR ID (GET)**
- **URL:** `http://localhost:8080/habits/1`
- **Method:** `GET`

#### **4. ‚úèÔ∏è ACTUALIZAR H√ÅBITO (PUT)**
- **URL:** `http://localhost:8080/habits/1`
- **Method:** `PUT`
- **Headers:** `Content-Type: application/json`
- **Body (raw/JSON):**
```json
{
  "nombre": "Ejercicio intensivo",
  "tipo": "Salud F√≠sica",
  "frecuencia": "Mensual",
  "objetivo": "Ejercicio de alta intensidad una vez al mes"
}
```

#### **5. üóëÔ∏è ELIMINAR H√ÅBITO (DELETE)**
- **URL:** `http://localhost:8080/habits/1`
- **Method:** `DELETE`

### üìÅ Colecci√≥n Recomendada para Postman

Crea carpetas organizadas:
- üìÅ **CRUD B√°sico**
  - POST - Crear H√°bito
  - GET - Listar Todos
  - GET - Ver por ID
  - PUT - Actualizar
  - DELETE - Eliminar
- üìÅ **Filtros**
  - GET - Por Tipo
  - GET - Por Frecuencia
- üìÅ **Validaciones**
  - POST - Error Nombre Vac√≠o
  - POST - Error Tipo Inv√°lido
  - POST - Error Frecuencia Inv√°lida

### üß™ Secuencia de Prueba Recomendada

1. **GET** `/habits` (verificar vac√≠o)
2. **POST** crear 3 h√°bitos diferentes
3. **GET** `/habits` (verificar que se crearon)
4. **GET** `/habits/1` (ver uno espec√≠fico)
5. **PUT** `/habits/1` (actualizar)
6. **GET** `/habits/tipo/Mental` (filtrar)
7. **DELETE** `/habits/2` (eliminar)
8. **GET** `/habits` (verificar estado final)

## ‚úÖ Validaciones

### Validaciones Implementadas:

- **nombre:** No puede estar vac√≠o o ser null
- **tipo:** Solo acepta: `"Salud F√≠sica"`, `"Mental"`, `"Alimentaci√≥n"`
- **frecuencia:** Solo acepta: `"Diario"`, `"Semanal"`, `"Mensual"`
- **objetivo:** No puede estar vac√≠o o ser null

### Anotaciones Personalizadas:

- `@ValidTipo` - Valida tipos permitidos
- `@ValidFrecuencia` - Valida frecuencias permitidas
- `@NotNull` y `@NotBlank` - Campos obligatorios

## ‚ö†Ô∏è Manejo de Errores

### Respuestas de Error Estandarizadas:

```json
{
  "timestamp": "2024-01-09T17:30:00",
  "status": 400,
  "error": "Bad Request",
  "message": "El tipo debe ser: Salud F√≠sica, Mental o Alimentaci√≥n",
  "path": "/habits"
}
```

### C√≥digos de Estado HTTP:

- **200** - Operaci√≥n exitosa
- **201** - Recurso creado exitosamente
- **400** - Error de validaci√≥n
- **404** - Recurso no encontrado
- **500** - Error interno del servidor

## üìÅ Estructura del Proyecto

```
src/main/java/com/HealthyHabits/HealthyHabits/
‚îú‚îÄ‚îÄ HealthyHabitsApplication.java          # Clase principal
‚îú‚îÄ‚îÄ controller/
‚îÇ   ‚îî‚îÄ‚îÄ HabitController.java               # Controlador REST
‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îî‚îÄ‚îÄ HabitDTO.java                      # Data Transfer Object
‚îú‚îÄ‚îÄ entity/
‚îÇ   ‚îî‚îÄ‚îÄ Habit.java                         # Entidad JPA
‚îú‚îÄ‚îÄ exception/
‚îÇ   ‚îú‚îÄ‚îÄ GlobalExceptionHandler.java        # Manejo global de errores
‚îÇ   ‚îî‚îÄ‚îÄ ErrorResponse.java                 # Respuesta de error estandarizada
‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îî‚îÄ‚îÄ HabitRepository.java               # Repositorio JPA
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îî‚îÄ‚îÄ HabitService.java                  # L√≥gica de negocio
‚îî‚îÄ‚îÄ validation/
    ‚îú‚îÄ‚îÄ ValidTipo.java                     # Anotaci√≥n personalizada
    ‚îú‚îÄ‚îÄ TipoValidator.java                 # Validador de tipo
    ‚îú‚îÄ‚îÄ ValidFrecuencia.java               # Anotaci√≥n personalizada
    ‚îî‚îÄ‚îÄ FrecuenciaValidator.java           # Validador de frecuencia

src/main/resources/
‚îú‚îÄ‚îÄ application.properties                 # Configuraci√≥n de la aplicaci√≥n
‚îî‚îÄ‚îÄ static/                               # Recursos est√°ticos (vac√≠o)
```

## üîß Soluci√≥n de Problemas

### Puerto 8080 en uso

```bash
# Windows - Encontrar proceso usando puerto 8080
netstat -ano | findstr :8080

# Matar proceso espec√≠fico (reemplazar PID)
taskkill /F /PID <PID>

# O cambiar puerto en application.properties
server.port=8081
```

### Error de conexi√≥n a MySQL

1. **Verificar que MySQL est√© corriendo:**
```bash
# Windows
net start mysql80

# macOS
brew services start mysql

# Linux
sudo systemctl start mysql
```

2. **Verificar credenciales** en `application.properties`

3. **Verificar que la base de datos existe:**
```sql
mysql -u root -p
SHOW DATABASES;
```

### Error "Access denied for user 'root'"

- Cambiar la contrase√±a en `application.properties`
- O resetear la contrase√±a de MySQL:
```bash
mysql -u root -p
ALTER USER 'root'@'localhost' IDENTIFIED BY 'Manchester17';
FLUSH PRIVILEGES;
```

### Dependencias no encontradas

```bash
# Limpiar y reconstruir
./gradlew clean build --refresh-dependencies
```

## üìû Soporte

Si encuentras alg√∫n problema:

1. Verifica que MySQL est√© corriendo
2. Verifica las credenciales en `application.properties`
3. Revisa los logs de la aplicaci√≥n en IntelliJ
4. Aseg√∫rate de que el puerto 8080 est√© libre

---

¬°Proyecto creado con ‚ù§Ô∏è usando Spring Boot 3 y MySQL! üöÄ 